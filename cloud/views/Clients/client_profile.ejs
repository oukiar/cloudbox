<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="content-type" content="text/html;charset=UTF-8" />
    <meta charset="utf-8" />
    <title>LC Cargo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta content="" name="description" />
    <meta content="" name="author" />
    <% include ../generals/ultraAdmin.ejs %>
    <!--ADMIN REQUIREMENTS-->   

	   <script src="/cod/js/moment.js"></script>
	   <script src="/cod/js/common.js"></script>
	   <script src="/cod/js/jquery-1.11.2.min.js"></script>
	   <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.3/themes/smoothness/jquery-ui.css"/>
	   <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.3/jquery-ui.min.js"></script>
	    <script src="//www.parsecdn.com/js/parse-1.4.2.min.js"></script>
  	  	    <script>
 /* 
    	 Parse.initialize("1MlFlpCslJWzRjZtFfSeUWDRXAS2zbszG2PuQ5Dd", "dREeQXyg3Zn7C8GG1eELLpaaBsGtI6A7BAVwA2sU");
  	  function updateClientInfo(){
		  var clientName = document.getElementById("clientName");
  		  Parse.Cloud.run('updateClientInfo', { clientName: clientName}, {
  		    success: function() {
  		  alert("success");
  		    },
  		    error: function() {
				alert("Error, please refresh the website and try again! Sorry! :(");
  		    }
  		  });
  	  }
	  */
	  
	  	  
  	  </script>
	 
	   
    </head>
    <!-- END HEAD -->
    <!-- BEGIN BODY -->
    <body>
 		<!--START TOPBAR-->
 		 
		<% include generals/topbar.ejs %>
        <!-- START CONTAINER -->
        <div class="page-container row-fluid">
		<% include generals/sideBar.ejs %>
        <!-- SIDEBAR - START -->
 		
        <!--  SIDEBAR - END -->	
        <!-- START CONTENT -->
        <div style="position:relative; left:144px;">
        <section class="wrapper" style='margin-top:60px;display:inline-block;width:100%;'>
            <div class='col-lg-12 col-md-12 col-sm-12 col-xs-12'>
                <div class="page-title">
                    <div class="pull-left">
 			
                        <div style="position:relative; left:144px;">  
                            <h1 class="title">Personal Information</h1>
                        </div>
                        
                        <div style="margin-left:30%; width:500px;">
			  
                        <form name="clientEmails" action="/">
                            <div class="content-body">    
                                <div class="row">
                                    <div class="col-md-12 col-sm-12 col-xs-12">

                                       <div class="form-group">
                                           <label class="form-label" for="field-1">Full Name:</label>
                                           <div class="controls">
                                               <input type="text" class="form-control" maxlength="55" id="clientName" name="clientName" value="<%= client.get('Name') %>" >
                                           </div>
                                       </div>
                                        
                                        <div class="form-group">
                                           <label class="form-label" for="field-1">Address:</label>
                                           <div class="controls">
                                               <input type="text" class="form-control" maxlength="55" id="clientAddress" name="clientAddress" value="<%= client.get('Address') %>" >
                                           </div>
                                       </div>
                                        
                                        <div class="form-group">
                                           <label class="form-label" for="field-1">Account #:</label>
                                           <div class="controls">
                                               <input type="text" class="form-control" maxlength="55" id="clientAccountID" name="clientAccountID" value="<%= client.get('AccountID') %>" >
                                           </div>
                                       </div>
                                       
                                        <div class="form-group">
                                           <label class="form-label" for="field-1">State:</label>
                                           <div class="controls">
                                               <input type="text" class="form-control" maxlength="55" id="clientState" name="clientState" value="<%= client.get('State') %>" >
                                           </div>
                                       </div>
                                       
                                        <div class="form-group">
                                           <label class="form-label" for="field-1">Country:</label>
                                           <div class="controls">
                                               <input type="text" class="form-control" maxlength="55" id="clientCountry" name="clientCountry" value="<%= client.get('Country') %>" >
                                           </div>
                                       </div>
                                       
                                        <div class="form-group">
                                           <label class="form-label" for="field-1">Zip code:</label>
                                           <div class="controls">
                                               <input type="text" class="form-control" maxlength="55" id="clientZip" name="clientZip" value="<%= client.get('Zip') %>" >
                                           </div>
                                       </div>
                                       
                                        <div class="form-group">
                                           <label class="form-label" for="field-1">Cel:</label>
                                           <div class="controls">
                                               <input type="text" class="form-control" maxlength="55" id="clientCel" name="clientCel" value="<%= client.get('Cellphone') %>" >
                                           </div>
                                       </div>

                                       <div class="form-group">
                                           <label class="form-label" for="field-1">Language:</label>
                                           <div class="controls">
                                                <select  class="multi-select" id="clientLanguage" name="clientLanguage">
                                                <option value="Spanish">Spanish</option>
                                                <option value="English">English</option>
                                                </select>
                                           </div>
                                       </div>

                                       <div class="form-group">
                                           <label class="form-label" for="field-1">ID:</label>
                                           <div class="controls">
                                               <input type="text" class="form-control" maxlength="55" id="clientID1" name="clientID1" value="<%= client.get('ID1') %>">
                                           </div>
                                       </div>

                                       <div class="form-group">
                                           <label class="form-label" for="field-1">Telephone:</label>
                                           <div class="controls">
                                               <input maxlength="55" id="clientTelephone" name="clientTelephone" type="text" class="form-control"  value="<%= client.get('Telephone') %>">
                                           </div>
                                       </div>

                                       <div class="form-group">
                                           <label class="form-label" for="field-1">Email:</label>
                                           <div class="controls">
                                               <input type="text" class="form-control" maxlength="55" id="clientEmail" name="clientEmail" value="<%= client.get('Email') %>" >
                                           </div>
                                       </div>
				  
	                   
	     
                                        <div class="form-group">
                                            <input type="button" id="btn_updateInformation" style="length:50px;" value="Update Information" class="pure-button pure-button-primary">
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </section>
	             
        </div>
		</div>
		
		
        <!-- START CONTENT -->
        <div style="position:relative; left:144px; top:5px;">
            <section class="wrapper" style='display:inline-block;width:100%;'>


                <div class="content-body">    
                    <div class="row" style="margin-left:30%; width:500px;">

                        <div class='col-lg-12 col-md-12 col-sm-12 col-xs-12'>
                            <div class="page-title">
                                <div class="pull-left">
                    
                                    <div style="position:relative; left:144px;">  
                                        <h1 class="title">Destinations - Consignees</h1>
                                    </div>
                                    
                                    <table id="lst_consignees" style="width:100%;" class="table table-bordered" >
                                        <thead>
                                            <tr>
                                                <th>Name</th>
                                                <th>Country</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>

                                        <tbody>
                                        </tbody>
                                    </table>
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div><!-- END CONTAINER -->
	              <!-- LOAD FILES AT PAGE END FOR FASTER LOADING -->
	              <!-- modal end -->
				  
				  
		  	       <!-- START CONTENT -->
		           <div style="position:relative; left:144px; top:5px;">
		  	          <section class="wrapper" style='display:inline-block;width:100%;'>
		  	                <div class='col-lg-12 col-md-12 col-sm-12 col-xs-12'>
		  	                <div class="page-title">
		  	                <div class="pull-left">
 			
		  	              <div style="position:relative; left:144px;">  <h1 class="title">Password:</h1></div>
		  	  		       <div style="margin-left:30%; width:500px;">
			  
		  	  	<form name="clientPass" action="/">
		  	       <div class="content-body">
		  			   <div class="row">
		  	               <div class="col-md-12 col-sm-12 col-xs-12">
	                   <div class="form-group">
	                       <label class="form-label" for="field-1">New Password:</label>
	                       <div class="controls">
	                           <input type="password" class="form-control" maxlength="55" id="clientPassword" name="clientPassword"  >
	                       </div>
	                   </div>
					   
	                   <div class="form-group">
	                       <label class="form-label" for="field-1">Re-type New Password:</label>
	                       <div class="controls">
	                           <input type="password" class="form-control" maxlength="55" id="clientRTPassword" name="clientRTPassword"  >
	                       </div>
	                   </div>
		  	 	     
			 	 	<div class="form-group">
			 	 	<input type="button" id="btn_registerStore" style="length:50px;" value="Change Password" class="pure-button pure-button-primary">
			 	    </div>

		  	  		     </div>
		  	              </div>
		  	              </div>
		  	              </section>
	             
		  	              <!-- END CONTENT -->
		  	              </div><!-- END CONTAINER -->
		  	              <!-- LOAD FILES AT PAGE END FOR FASTER LOADING -->
		  	              <!-- modal end -->		  
		                  </div>
		

    <div id="modalEditClient" class="modalDialog">
        <a href="#close" title="Close" class="close">X</a>

        <div>
            <a href="#close" title="Close" class="closeB">X</a>
            <h3>Consignee Information</h3>
            
            <br>
            
            <table class="table table-bordered" id="blueRow">
                <tr>
                    <td><b>Name:</b></td><td id="tdCName" contenteditable='true'><div id='clientNameInfo'></div></td>
                </tr>
                <tr>
                    <td>
                        <b>Address</b>
                    </td>
                    <td id="tdCAddress" contenteditable='true'>
                        <div id="clientAddress"></div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <b>Account #</b>
                    </td>
                    <td id="tdCAccount" contenteditable='true'>
                        <div id="clientAccount"></div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <b>State:</b>
                    </td>
                    <td id="tdCState" contenteditable='true'>
                        <div id='clientState'></div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <b>Country:</b>
                    </td>
                    <td id="tdCCountry" contenteditable='true'>
                        <div id='clientCountryInfo'></div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <b>Zip:</b>
                    </td>
                    <td id="tdCZip" contenteditable='true'>
                        <div id='clientZip'></div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <b>Cellphone:</b>
                    </td>
                    <td id="tdCCel" contenteditable='true'>
                        <div id='clientCel'></div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <b>Email:</b>
                    </td>
                    <td id="tdCEmail" contenteditable='true'>
                        <div id='clientEmailInfo'></div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <b>Telephone:</b>
                    </td>
                    <td id="tdCTel" contenteditable='true'>
                        <div id='clientTelephoneInfo'></div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <b>ID:</b></td><td id="tdCID" contenteditable='true'>
                        <div id='clientIDInfo'></div>
                    </td>
                </tr>
                <!--<tr>
                <td><b>Destinations:</b></td><td id="tdCDest" contenteditable='false'><div id='clientDestinationInfo'></div></td>
                </tr>
                <tr>
                <td><b>Status:</b></td><td id="tdCStatus" contenteditable='false'><div id='clientStatusInfo'></div></td>
                </tr>-->
            </table>
            
            <a  href="#close" class="pure-button pure-button-primary" style="background:#E08566;">Cancel</a>
            <a href="#close" id="saveConsignee" class="pure-button pure-button-primary" onclick="updateClientTable();">Save</a>
        </div>

    </div>
    
		
      <%include ../generals/endFiles.ejs%>
	  
    <script>
         

    if( window.location.href.indexOf("cloudbox.parseapp") !=-1 )
        Parse.initialize("Slh0vzK6DCaarshvF1Vu0ku3Rx2hwDdTaYwW7DLU", "TkJgyQRuMqqKtzZ6bEjdESPiUZ6sVkg3QntIxmh7");
    else
        Parse.initialize("XEPryFHrd5Tztu45du5Z3kpqxDsweaP1Q0lt8JOb", "MDhb1hBngr2tx2v9TjyzoUhMcOFeWGJ56TWvChqi");


    /* GLOBAL USER */
    var user;

    /* OBTENCION Y ALMACENAMIENTO DEL CURRENT USER PARA USARSE CLIENTSIDE */
    var query = new Parse.Query("User");
    
    query.descending('createdAt');
    query.include("Company");
    query.include("ClientID");
    
    query.get("<%= Parse.User.current().id %>", {
        success: 
            function(object)
            {                
                /* SAVE USER FOR FUTURE OPERATIONS */
                user = object;
                
                /* LLENAR LISTA DE CONSIGNEES */
                var query = new Parse.Query("Clients");
                
                query.equalTo("MainClient", user.get("ClientID") );
                
                query.find({success:function(results){
                                                
                        for(i in results)
                        {
                            /*
                            alert(results[i].get("Name"));
                            */
                            $("#lst_consignees > tbody").append("<tr><td>"+ 
                                                            results[i].get("Name") +"</td><td>"+ 
                                                            results[i].get("Country") +"</td><td><a href='#modalEditClient' onclick='onEditClient(\""+ results[i].id +
                                                            "\")' class='btn btn-border btn-orange'><i class='fa fa-pencil-square-o'></i> Edit</a><a class='btn btn-border btn-danger'><i class='fa fa-trash-o'></i></a></td></tr>");
                        }
                    }});
                
            }});
         
     $("#btn_updateInformation").click(function(){
            
            var Client = Parse.Object.extend("Clients");
            var client = new Client();
            
            client.id = user.get("ClientID").id;
            
            client.set("Name", $("#clientName").val() );
            client.set("Address", $("#clientAddress").val() );
            client.set("AccountID", $("#clientAccountID").val() );
            client.set("State", $("#clientState").val() );
            client.set("Country", $("#clientCountry").val() );
            client.set("Zip", $("#clientZip").val() );
            client.set("Cellphone", $("#clientCel").val() );
            client.set("Language", $("#clientLanguage").val() );
            client.set("ID1", $("#clientID1").val() );
            client.set("Telephone", $("#clientTelephone").val() );
            client.set("Email", $("#clientEmail").val() );
            
            client.save({success: function(){alert("SAVED");}});
            
         });
        
        var consigneeID = -1;
        
        function onEditClient(objectId)
        {
            consigneeID = objectId;
        
            var query = new Parse.Query("Clients");
            
            query.get(objectId, {success: function(client){
                            
                    $("#tdCName").html(tryget(client.get("Name") ));
                    $("#tdCAccount").html(tryget(client.get("AccountID")));
                    $("#tdCCountry").html(tryget(client.get("Country")));
                    $("#tdCEmail").html(tryget(client.get("Email")) );
                    $("#tdCTel").html(tryget(client.get("Telephone")));
                    $("#tdCID").html(tryget(client.get("ID1")));
                    /*$("#tdCDest").html(tryget(client.get("Name"));*/
                    $("#tdCStatus").html(tryget(client.get("Status")));
                }});
            
        }
        
        $("#saveConsignee").click(function(){
                alert("SAVE");
                
                var Client = Parse.Object.extend("Clients");
                var client = new Client();
                
                client.id = consigneeID;
                
                client.set("Name", $("#tdCName").text() );
                client.set("Address", $("#clientAddress").val() );
                client.set("AccountID", $("#clientAccountID").val() );
                client.set("State", $("#clientState").val() );
                client.set("Country", $("#clientCountry").val() );
                client.set("Zip", $("#clientZip").val() );
                client.set("Cellphone", $("#clientCel").val() );
                client.set("Language", $("#clientLanguage").val() );
                client.set("ID1", $("#clientID1").val() );
                client.set("Telephone", $("#clientTelephone").val() );
                client.set("Email", $("#clientEmail").val() );
                
                client.save({success: function(){alert("SAVED");}});
                
            });
         
    </script>
	 
    </body>
</html>
